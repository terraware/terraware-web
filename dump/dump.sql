-- Add a dummy user for CI tests. In tests, we'll bypass the login flow by pretending
-- that we already have a valid login session.
INSERT INTO users (id, auth_id, email, first_name, last_name, user_type_id, created_time,
                   modified_time)
VALUES (1, '0d04525c-7933-4cec-9647-7b6ac2642838', 'nobody@terraformation.com', 'Test', 'User', 1, NOW(), NOW())
ON CONFLICT (id) DO UPDATE SET auth_id = excluded.auth_id,
                               first_name = excluded.first_name,
                               last_name = excluded.last_name,
                               email = excluded.email;

-- Insert some dummy data into the database for demo purposes
INSERT INTO organizations (id, name, created_time, modified_time)
VALUES (1, 'Terraformation (staging)', NOW(), NOW())
ON CONFLICT (id) DO UPDATE SET name = excluded.name;

INSERT INTO organization_users (user_id, organization_id, role_id, created_time, modified_time)
VALUES (1, 1, 4, NOW(), NOW())
ON CONFLICT (user_id, organization_id) DO UPDATE SET role_id = excluded.role_id;

INSERT INTO projects (id, organization_id, name, created_time, modified_time)
VALUES (10, 1, 'Example Project', NOW(), NOW())
ON CONFLICT (id) DO UPDATE SET name = excluded.name;

INSERT INTO project_users (user_id, project_id, created_time, modified_time)
VALUES (1, 10, NOW(), NOW())
ON CONFLICT DO NOTHING;

INSERT INTO sites (id, project_id, name, latitude, longitude, locale, timezone)
VALUES (10, 10, 'Example Site', 123.456789, -98.76543, 'en-US', 'US/Pacific')
ON CONFLICT (id) DO UPDATE SET name = excluded.name;

INSERT INTO facilities (id, site_id, type_id, name)
VALUES (100, 10, 1, 'ohana'),
       (101, 10, 1, 'garage')
ON CONFLICT (id) DO UPDATE SET site_id = excluded.site_id,
                               name    = excluded.name;

INSERT INTO storage_locations (id, facility_id, name, condition_id)
VALUES (1000, 100, 'Refrigerator 1', 1),
       (1001, 100, 'Freezer 1', 2),
       (1002, 100, 'Freezer 2', 2)
ON CONFLICT (id) DO UPDATE SET name         = excluded.name,
                               condition_id = excluded.condition_id;

DELETE FROM notifications;
DELETE FROM accession_photos;
DELETE FROM photos;
DELETE FROM geolocations;
DELETE FROM bags;
DELETE FROM germinations;
DELETE FROM germination_tests;
DELETE FROM withdrawals;
DELETE FROM accession_germination_test_types;
DELETE FROM accession_secondary_collectors;
DELETE FROM accession_state_history;
DELETE FROM accessions;
DELETE FROM app_devices;
DELETE FROM family_names;
DELETE FROM families;
DELETE FROM species_names;
DELETE FROM species;

INSERT INTO species (id, name, is_scientific, created_time, modified_time)
VALUES (10000, 'Kousa Dogwood', false, NOW(), NOW()),
       (10001, 'Other Dogwood', false, NOW(), NOW())
ON CONFLICT (id) DO UPDATE SET name = excluded.name,
                               is_scientific = excluded.is_scientific;

INSERT INTO species_names (species_id, name, is_scientific, created_time, modified_time)
SELECT id, name, is_scientific, created_time, modified_time
FROM species
ON CONFLICT (id) DO UPDATE SET name = excluded.name,
                               is_scientific = excluded.is_scientific;

INSERT INTO families (id, name, is_scientific, created_time, modified_time)
VALUES (20000, 'Dogwood', false, NOW(), NOW())
ON CONFLICT (id) DO UPDATE SET name = excluded.name,
                               is_scientific = excluded.is_scientific;

INSERT INTO family_names (family_id, name, is_scientific, created_time, modified_time)
SELECT id, name, is_scientific, created_time, modified_time
FROM families
ON CONFLICT (id) DO UPDATE SET name = excluded.name,
                               is_scientific = excluded.is_scientific;

INSERT INTO accessions (id, number, state_id, facility_id, created_time, species_id,
                       family_id, trees_collected_from)
VALUES (1000, 'XYZ', 30, 100, '2021-01-03T15:31:20Z', 10000, 20000, 1),
       (1001, 'ABCDEFG', 20, 100, '2021-01-10T13:08:11Z', 10001, 20000, 2)
ON CONFLICT (id) DO UPDATE SET number           = excluded.number,
                               state_id         = excluded.state_id,
                               species_id       = excluded.species_id,
                               trees_collected_from = excluded.trees_collected_from;

INSERT INTO notifications (id, site_id, type_id, accession_id, created_time, read, message,
                          accession_state_id)
VALUES (100000, 10, 1, NULL, '2021-01-01T11:22:33Z', FALSE, 'This is an example alert', NULL),
       (100001, 10, 3, 1000, '2021-01-15T08:01:00Z', FALSE, 'Accession XYZ has exploded!', NULL),
       (100002, 10, 2, NULL, '2021-01-25T08:05:00Z', FALSE, 'Accessions are pending!', 10),
       (100003, 10, 2, NULL, '2021-01-25T08:05:01Z', FALSE, 'Accessions are processing!', 20),
       (100004, 10, 2, NULL, '2021-01-25T08:05:02Z', FALSE, 'Accessions are processed!', 30),
       (100005, 10, 2, NULL, '2021-01-25T08:05:03Z', FALSE, 'Accessions are drying!', 40),
       (100006, 10, 2, NULL, '2021-01-25T08:05:04Z', FALSE, 'Accessions are dried!', 50),
       (100007, 10, 2, NULL, '2021-01-25T08:05:05Z', FALSE, 'Accessions are in storage!', 60),
       (100008, 10, 2, NULL, '2021-01-25T08:05:06Z', FALSE, 'Accessions are withdrawn!', 70),
       (100009, 10, 3, 1001, '2021-01-27T08:00:00Z', FALSE, 'Accession ABCDEFG needs help!', NULL)
ON CONFLICT (id) DO UPDATE SET type_id            = excluded.type_id,
                               accession_id       = excluded.accession_id,
                               created_time       = excluded.created_time,
                               read               = excluded.read,
                               message            = excluded.message,
                               accession_state_id = excluded.accession_state_id;

INSERT INTO "app_devices" ("id", "app_name", "created_time") VALUES (1, 'cel', '2021-02-12 17:21:33.62729+00');

INSERT INTO "accessions" ("id", "facility_id", "app_device_id", "number", "species_id", "state_id", "trees_collected_from", "family_id", "created_time") VALUES
(1002,	100,	1,	'AAF4D49R3E',	10000,	30,	1,	20000,	'2021-01-03 15:31:20+00');

INSERT INTO "bags" ("id", "accession_id", "bag_number") VALUES
(1001,	1002,	'ABCD001237'),
(1002,	1002,	'ABCD001238');

INSERT INTO "geolocations" ("id", "accession_id", "created_time", "latitude", "longitude", "gps_accuracy") VALUES
(1001,	1002,	'2021-02-12 17:21:33.62729+00',	9.0300000,	-79.5300000,	NULL);

INSERT INTO photos (id, captured_time, file_name, content_type, size, created_time, modified_time,
                    storage_url) VALUES
(1001, '2021-02-03 11:33:44+00', 'accession1.jpg', 'image/jpeg', 6441, '2021-02-12 18:36:15.842405+00', '2021-02-12 18:36:15.842405+00', 'file:///100/A/A/F/AAF4D49R3E/accession1.jpg'),
(1002, '2021-02-03 11:33:44+00', 'accession2.jpg', 'image/jpeg', 6539, '2021-02-12 18:36:15.903768+00', '2021-02-12 18:36:15.903768+00', 'file:///100/A/A/F/AAF4D49R3E/accession2.jpg');

INSERT INTO accession_photos (photo_id, accession_id) VALUES (1001, 1002), (1002, 1002);

-- Session data. The big hex blob is a serialized Java object; it was created by logging into a
-- real terraware-server instance using Keycloak and querying the session store, then tweaking
-- the idle and expiration times so it will remain valid for testing.
INSERT INTO spring_session (primary_id, session_id, creation_time, last_access_time,
                            max_inactive_interval, expiry_time, principal_name)
VALUES ('b84131c0-7bee-4363-827e-291becc06698', '276714ad-ab0a-48aa-8ef8-db65ec2e950a',
        1632267607787, 1632267674313, 315360000, 3000000000000,
        '0d04525c-7933-4cec-9647-7b6ac2642838')
ON CONFLICT (primary_id) DO UPDATE SET session_id = excluded.session_id,
                                       max_inactive_interval = excluded.max_inactive_interval,
                                       expiry_time = excluded.expiry_time,
                                       principal_name = excluded.principal_name;

INSERT INTO spring_session_attributes (session_primary_id, attribute_name, attribute_bytes)
VALUES ('b84131c0-7bee-4363-827e-291becc06698', 'SPRING_SECURITY_CONTEXT', '\xaced00057372003d6f72672e737072696e676672616d65776f726b2e73656375726974792e636f72652e636f6e746578742e5365637572697479436f6e74657874496d706c000000000000021c0200014c000e61757468656e7469636174696f6e7400324c6f72672f737072696e676672616d65776f726b2f73656375726974792f636f72652f41757468656e7469636174696f6e3b7870737200466f72672e6b6579636c6f616b2e61646170746572732e737072696e6773656375726974792e746f6b656e2e4b6579636c6f616b41757468656e7469636174696f6e546f6b656eda86957eca6a83df0200025a000b696e7465726163746976654c00097072696e636970616c7400194c6a6176612f73656375726974792f5072696e636970616c3b787200476f72672e737072696e676672616d65776f726b2e73656375726974792e61757468656e7469636174696f6e2e416273747261637441757468656e7469636174696f6e546f6b656ed3aa287e6e47640e0200035a000d61757468656e746963617465644c000b617574686f7269746965737400164c6a6176612f7574696c2f436f6c6c656374696f6e3b4c000764657461696c737400124c6a6176612f6c616e672f4f626a6563743b787001737200266a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c654c697374fc0f2531b5ec8e100200014c00046c6973747400104c6a6176612f7574696c2f4c6973743b7872002c6a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c65436f6c6c656374696f6e19420080cb5ef71e0200014c00016371007e00067870737200136a6176612e7574696c2e41727261794c6973747881d21d99c7619d03000149000473697a65787000000003770400000003737200396f72672e6b6579636c6f616b2e61646170746572732e737072696e6773656375726974792e6163636f756e742e4b6579636c6f616b526f6c65e5b7a8aba8a1b6330200014c0004726f6c657400124c6a6176612f6c616e672f537472696e673b787074001764656661756c742d726f6c65732d7465727261776172657371007e000f74000e6f66666c696e655f6163636573737371007e000f740011756d615f617574686f72697a6174696f6e7871007e000e737200426f72672e6b6579636c6f616b2e61646170746572732e737072696e6773656375726974792e6163636f756e742e53696d706c654b6579636c6f616b4163636f756e74ea2aacae4326d7000200034c00097072696e636970616c71007e00044c0005726f6c657374000f4c6a6176612f7574696c2f5365743b4c000f7365637572697479436f6e7465787474003a4c6f72672f6b6579636c6f616b2f61646170746572732f5265667265736861626c654b6579636c6f616b5365637572697479436f6e746578743b78707372001e6f72672e6b6579636c6f616b2e4b6579636c6f616b5072696e636970616c87bb732ef1ba8cde0200024c0007636f6e746578747400264c6f72672f6b6579636c6f616b2f4b6579636c6f616b5365637572697479436f6e746578743b4c00046e616d6571007e00107870737200386f72672e6b6579636c6f616b2e61646170746572732e5265667265736861626c654b6579636c6f616b5365637572697479436f6e7465787466f37797d76b64c00200014c000c72656672657368546f6b656e71007e0010787200246f72672e6b6579636c6f616b2e4b6579636c6f616b5365637572697479436f6e74657874f4f6350ff310d0110300024c000d6964546f6b656e537472696e6771007e00104c000b746f6b656e537472696e6771007e001078707404ea65794a68624763694f694a53557a49314e694973496e5235634349674f694169536c64554969776961326c6b4969413649434a4c6357647564544e5862556b31635868474d3052736432316e536d3946646e4e50656c7056546a42754f444179563141335156644664554e56496e302e65794a6c654841694f6a45324d7a497a4d444d324e7a5173496d6c68644349364d54597a4d6a49324e7a59334e43776959585630614639306157316c496a6f784e6a4d794d6a59334e6a63304c434a7164476b694f694933596a513459546c6a5953316d5a6a5a6b4c5451784d575974595755324d53316d4f4463774e5455774e4463344e3255694c434a7063334d694f694a6f64485277637a6f764c32463164476775633352685a326c755a7935305a584a7959586468636d55756157387659585630614339795a57467362584d7664475679636d463359584a6c496977695958566b496a6f695a4756324c58526c636e4a68643246795a53317a5a584a325a5849694c434a7a645749694f6949775a4441304e544931597930334f544d7a4c54526a5a574d744f5459304e793033596a5a68597a49324e4449344d7a67694c434a30655841694f694a4a52434973496d463663434936496d526c646931305a584a7959586468636d557463325679646d5679496977696332567a63326c76626c397a644746305a534936496d49354f5459344e575a694c5455334f5445744e446b795a6931695954646a4c574d774d6a457a593245774d474a684d694973496d463058326868633267694f694a4d4d325a6f5347746c55533148596a42486146706d54556333656d56524969776959574e79496a6f694d534973496d567459576c7358335a6c636d6c6d6157566b496a7030636e566c4c434a755957316c496a6f6954334a6e4d554e76626e527961574a31644739794945526c625738694c434a77636d566d5a584a795a57526664584e6c636d3568625755694f694a7a644756325a57347262334a6e4d574e76626e527961574a31644739795148526c636e4a685a6d397962574630615739754c6d4e7662534973496d6470646d567558323568625755694f694a50636d63785132397564484a70596e5630623349694c434a6d5957317062486c66626d46745a534936496b526c625738694c434a6c6257467062434936496e4e305a585a6c62697476636d63785932397564484a70596e563062334a4164475679636d466d62334a74595852706232347559323974496e302e726f6b427959534f586f70317a7156336d373565502d595a503655654b496d746e5744305235526949757473686844654d3144483533716a49787472395a713739526c494438386f755958313655356f703556395a546842415a303273494b4f553071586f6f426a656261655f4c627849324c70717464694f5f565851324a4b7a6b65616a484652484b3069584f63594b4b74346b30466f727631785f376e4c63554a716b616e46654542523965576e484645614d67434f5936775755544530654e754c3968482d34795476516f4d353070595548325f2d7739416a446c77416e7246324f4464677838366139544a385055764c7967766e49476d78623362356e585755514867305a424b56774a6a733338674d394e4675457a4248446771795343746f324373614c6f6d4d5863506d525a4b74736b436448726a326f613447665a765334526c6f4e43594b436c6d523538474a58777405d265794a68624763694f694a53557a49314e694973496e5235634349674f694169536c64554969776961326c6b4969413649434a4c6357647564544e5862556b31635868474d3052736432316e536d3946646e4e50656c7056546a42754f444179563141335156644664554e56496e302e65794a6c654841694f6a45324d7a497a4d444d324e7a5173496d6c68644349364d54597a4d6a49324e7a59334e43776959585630614639306157316c496a6f784e6a4d794d6a59334e6a63304c434a7164476b694f694a6d4e324577596d4a684d53316c4d6d45344c54526d4e7a4d74596a41785a53307a4e7a497a4d6d56684f4459334f4467694c434a7063334d694f694a6f64485277637a6f764c32463164476775633352685a326c755a7935305a584a7959586468636d55756157387659585630614339795a57467362584d7664475679636d463359584a6c496977695958566b496a6f6959574e6a6233567564434973496e4e3159694936496a426b4d4451314d6a566a4c5463354d7a4d744e474e6c597930354e6a51334c5464694e6d466a4d6a59304d6a677a4f434973496e523563434936496b4a6c59584a6c63694973496d463663434936496d526c646931305a584a7959586468636d557463325679646d5679496977696332567a63326c76626c397a644746305a534936496d49354f5459344e575a694c5455334f5445744e446b795a6931695954646a4c574d774d6a457a593245774d474a684d694973496d466a63694936496a45694c434a795a5746736256396859324e6c63334d694f6e7369636d39735a584d694f6c73695a47566d59585673644331796232786c637931305a584a7959586468636d55694c434a765a6d5a736157356c5832466a5932567a63794973496e5674595639686458526f62334a70656d463061573975496c31394c434a795a584e7664584a6a5a56396859324e6c63334d694f6e736959574e6a623356756443493665794a796232786c6379493657794a74595735685a32557459574e6a6233567564434973496d3168626d466e5a53316859324e76645735304c577870626d747a49697769646d6c6c64793177636d396d6157786c496c31396653776963324e76634755694f694a7663475675615751675a5731686157776763484a765a6d6c735a534973496d567459576c7358335a6c636d6c6d6157566b496a7030636e566c4c434a755957316c496a6f6954334a6e4d554e76626e527961574a31644739794945526c625738694c434a77636d566d5a584a795a57526664584e6c636d3568625755694f694a7a644756325a57347262334a6e4d574e76626e527961574a31644739795148526c636e4a685a6d397962574630615739754c6d4e7662534973496d6470646d567558323568625755694f694a50636d63785132397564484a70596e5630623349694c434a6d5957317062486c66626d46745a534936496b526c625738694c434a6c6257467062434936496e4e305a585a6c62697476636d63785932397564484a70596e563062334a4164475679636d466d62334a74595852706232347559323974496e302e433334633356384e5a3053525a3950793358666b4c774c7655474444436b727a4330526e7365764c676b6538584e7672327a304d6f445f33564c714d5469576a71654c4f4335794b57614d537a754c4a6a304c4e695643366e434f71596f773537396a42496267516932514275662d6d4c6e5532485a63347242775a774376462d686c4338536f393057363563324c57377574624c58624d38766249436b693341434a663279595f46734f3953647663757270653230745a395537336f6d746535564d6579484b615231333863513641667952564b6661776673414a4d6a424e53425643544e5261475541455a65576d4946696642506478553838544d6f6d4f705662416174307943675f644d776f434e6467725a6b31587a432d53637a73434970564266535f6d4a4232447543644b67526d78724b493464646241434a374b51357070366f667a427866573042686e4779453475517874029365794a68624763694f694a49557a49314e694973496e5235634349674f694169536c64554969776961326c6b49694136494349304e7a41304d325131596930315954646a4c545134596a59744f4463345979316c5a4456685a6a63334f4467775a54636966512e65794a6c654841694f6a45324d7a49794e6a6b304e7a5173496d6c68644349364d54597a4d6a49324e7a59334e437769616e5270496a6f694e32557a4d6a49305a6a49745a6d4e685a6930304d7a6b794c5745794f5745745a6a4e6b4f54526d4d6d5531595745794969776961584e7a496a6f696148523063484d364c7939686458526f4c6e4e3059576470626d637564475679636d463359584a6c4c6d6c764c32463164476776636d56686247317a4c33526c636e4a68643246795a534973496d46315a434936496d68306448427a4f693876595856306143357a6447466e6157356e4c6e526c636e4a68643246795a533570627939686458526f4c334a6c59577874637939305a584a7959586468636d55694c434a7a645749694f6949775a4441304e544931597930334f544d7a4c54526a5a574d744f5459304e793033596a5a68597a49324e4449344d7a67694c434a30655841694f694a535a575a795a584e6f4969776959587077496a6f695a4756324c58526c636e4a68643246795a53317a5a584a325a5849694c434a7a5a584e7a6157397558334e305958526c496a6f69596a6b354e6a67315a6d49744e5463354d5330304f544a6d4c574a684e324d74597a41794d544e6a59544177596d45794969776963324e76634755694f694a7663475675615751675a5731686157776763484a765a6d6c735a534a392e666f6b4471525075477a30676c466a7475742d6d6b474b6371654f6273594f714a587130506d4656457a5974002430643034353235632d373933332d346365632d393634372d376236616332363432383338737200116a6176612e7574696c2e48617368536574ba44859596b8b7340300007870770c000000103f4000000000000371007e001271007e001471007e00167871007e00200171007e001d')
ON CONFLICT (session_primary_id, attribute_name) DO UPDATE
SET attribute_bytes = excluded.attribute_bytes;
